var map,geocoder,markers=[],array_region=[],array_business=[],array_support=[],one_to_watch=0,endorsed=0;function LoadProgrammes(e,s,t,a,o){return console.log(o),full_url=window.location.href,path_url=window.location.pathname,home_url=full_url.replace(path_url,""),ajax_url=home_url+"/wp-admin/admin-ajax.php",$.ajax({url:ajax_url,type:"post",data:{action:"load_programmes",region:e,type_business:s,type_support:t,one_to_watch:a,endorsed:o},beforeSend:function(e){},success:function(e){$("#response-programmes").html(e)}}),!1}function initMap(){map=new google.maps.Map(document.getElementById("map"),{center:{lat:54.4071355,lng:-1.7539647},zoom:6,zoomControl:!0,streetViewControl:!1,mapTypeControl:!1,styles:[{featureType:"administrative",elementType:"all",stylers:[{saturation:"-100"}]},{featureType:"administrative.province",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"all",stylers:[{saturation:-100},{lightness:65},{visibility:"on"}]},{featureType:"poi",elementType:"all",stylers:[{saturation:-100},{lightness:"50"},{visibility:"simplified"}]},{featureType:"road",elementType:"all",stylers:[{saturation:"-100"}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"all",stylers:[{lightness:"30"}]},{featureType:"road.local",elementType:"all",stylers:[{lightness:"40"}]},{featureType:"transit",elementType:"all",stylers:[{saturation:-100},{visibility:"simplified"}]},{featureType:"water",elementType:"all",stylers:[{color:"#d2d2d2"},{visibility:"on"}]},{featureType:"water",elementType:"labels",stylers:[{lightness:-25},{saturation:-100}]}]}),geocoder=new google.maps.Geocoder}function SearchMarkers(){var e=$("#search_markers").data("url"),s=$("#input_address").val(),t=$("#input_business option:selected").text();return $.ajax({url:e,type:"post",data:{action:"load_posts",speciality:t},beforeSend:function(e){},success:function(e){$("#map-container").html(e),$("#map-container").css("visibility","hidden"),show_results(s)}}),!1}function show_results(e){setMapOnAll(null),markers=[],add_markers(),find_addres(e)}function setMapOnAll(){for(var e=0;e<markers.length;e++)markers[e].setMap(null)}function add_markers(){array_lat=$("#loop-location").data("lat"),array_lng=$("#loop-location").data("lng"),array_description=$("#loop-location").data("description");for(var e=0;e<array_lat.length;e++){var s=array_lat[e],t=array_lng[e],a=new google.maps.LatLng(s,t),o=array_description[e];markers[e]=new google.maps.Marker({position:a,map:map,description:o,id:e,icon:"http://localhost:8019/wp-content/themes/scaleUpTheme/assets/images/marker.png",animation:google.maps.Animation.DROP})}}function find_addres(e){geocoder.geocode({address:e},function(e,s){if("OK"==s){var t=e[0].geometry.location;map.setCenter();new google.maps.Marker({map:map,icon:"http://localhost:8019/wp-content/themes/scaleUpTheme/assets/images/location.png",position:t});calculate_distances(t.lat(),t.lng())}else alert("Geocode was not successful for the following reason: "+s)})}function calculate_distances(e,s){var t=Math.PI,a=[],o=-1;for(lat1=e,lon1=s,i=0;i<markers.length;i++){var r=markers[i].position.lat(),n=markers[i].position.lng(),l=(r-lat1)*(t/180),c=(n-lon1)*(t/180),p=lat1*(t/180),d=r*(t/180),u=Math.sin(l/2)*Math.sin(l/2)+Math.sin(c/2)*Math.sin(c/2)*Math.cos(p)*Math.cos(d),h=6371*(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)));a[i]=h,(-1==o||h<a[o])&&(o=i)}distances_sorted=Array.from(a),distances_sorted.sort(function(e,s){return e-s});var m=new Array;for(i=0;i<distances_sorted.length;i++)for(dist_sort=distances_sorted[i],j=0;j<a.length;j++)dist=a[j],dist_sort==dist&&(m.push(markers[j]),$("#cards-list .card").eq(j).attr("id",i));markers=m,sort_results()}function sort_results(){$("#cards-list .card").sort(function(e,s){return parseInt(e.id)-parseInt(s.id)}).each(function(){var e=$(this);e.remove(),$(e).appendTo("#cards-list")}),$("#map-container").css("visibility","visible")}function redirectTo(e,s){s?window.open(e,"_blank"):window.location.href=e}$(document).ready(function(){$("#submit-form").click(function(){SearchMarkers()}),$("input").on("keypress",function(e){13==(e.keyCode||e.which)&&SearchMarkers()}),$("body").on("mouseenter",".card",function(){$(this).css("background-color","#fdd38d"),index=$(this).attr("id");markers[index].setIcon("http://localhost:8019/wp-content/themes/scaleUpTheme/assets/images/marker_hover.png")}),$("body").on("mouseleave",".card",function(){$(this).css("background-color","white");markers[index].setIcon("http://localhost:8019/wp-content/themes/scaleUpTheme/assets/images/marker.png")}),$(".custom-link").mouseenter(function(){$(this).hasClass("active")||($(this).find(".line").removeClass("leaveLink"),$(this).find(".line").addClass("overLink"))}),$(".custom-link").mouseleave(function(){$(this).hasClass("active")||($(this).find(".line").removeClass("overLink"),$(this).find(".line").addClass("leaveLink"))});var e=1;if($(".slider").length>0){setInterval(function(){size=$(".text-slide").length,last=size-1,console.log(e),$(".text-slide").hide(),$(".text-slide").eq(e).fadeIn("slow"),(e+=1)==size&&(e=0)},1e4)}$("body").on("click",".submit-search",function(){array_region=[],array_business=[],array_support=[],$(".tick input:checkbox").prop("checked",!1),region=$("#dropdown-region :selected").val(),type_business=$("#dropdown-type-business :selected").val(),type_support=$("#dropdown-type-support :selected").val(),""!=region&&array_region.push(region),""!=type_business&&array_business.push(type_business),""!=type_support&&array_support.push(type_support),LoadProgrammes(array_region,array_business,array_support,one_to_watch,endorsed),checkbox_region="#checkbox-"+region,checkbox_business="#checkbox-"+type_business,checkbox_support="#checkbox-"+type_support,$(checkbox_region).prop("checked",!0),$(checkbox_business).prop("checked",!0),$(checkbox_support).prop("checked",!0)}),$("body").on("click",".one-to-watch",function(){0==one_to_watch?(one_to_watch=1,$(this).find(".checkbox .fas").css("display","block")):(one_to_watch=0,$(this).find(".checkbox .fas").css("display","none")),LoadProgrammes(array_region,array_business,array_support,one_to_watch,endorsed)}),$("body").on("click",".endorsed",function(){$(this).find(".checkbox .fas").toggle(),console.log(endorsed),0==endorsed?(endorsed=1,$(this).find(".checkbox .fas").css("display","block")):(endorsed=0,$(this).find(".checkbox .fas").css("display","none")),LoadProgrammes(array_region,array_business,array_support,one_to_watch,endorsed)}),$("body").on("click",".more-filters",function(){$(".filters-window").fadeToggle("slow")}),$("body").on("click",".filter-btn",function(){array_region=$("input[name=checkbox-region]:checked").map(function(){return $(this).val()}).get(),array_business=$("input[name=checkbox-business]:checked").map(function(){return $(this).val()}).get(),array_support=$("input[name=checkbox-support]:checked").map(function(){return $(this).val()}).get(),$(".filters-window").fadeToggle("slow"),LoadProgrammes(array_region,array_business,array_support,one_to_watch,endorsed),$("#dropdown-region").val(""),$("#dropdown-type-business").val(""),$("#dropdown-type-support").val("")})}),$(window).on("load",function(){$(".programmes-list").length>0&&LoadProgrammes(array_region,array_business,array_support,one_to_watch,endorsed)});